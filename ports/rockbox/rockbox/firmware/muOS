if [[ "$RB_STATE" == "BOOT" ]]; then
  DEVICE_ID="$(GET_VAR "device" "board/name")"
  # Store current idle input/display settings.
  IDLEDISP="$(GET_VAR "config" "settings/power/idle_display")"
  IDLEMUTE="$(GET_VAR "config" "settings/power/idle_mute")"
  IDLESLEEP="$(GET_VAR "config" "settings/power/idle_sleep")"
  if [[ "$DEVICE_ID" == "rg35xx-sp" || "$DEVICE_ID" == "rg34xx-sp" ]]; then
    LIDSWITCHSET="$(GET_VAR "config" "settings/advanced/lidswitch")"
  fi
  BACKLIGHT_VAL="$(DISPLAY_READ lcd0 getbl)"
  # Override idle settings.
  SET_VAR "config" "settings/power/idle_display" 0
  SET_VAR "config" "settings/power/idle_mute" 0
  SET_VAR "config" "settings/power/idle_sleep" 0
  if [[ "$DEVICE_ID" == "rg35xx-sp" || "$DEVICE_ID" == "rg34xx-sp" ]]; then
    SET_VAR "config" "settings/advanced/lidswitch" 0
  fi
  HOTKEY restart
elif [[ "$RB_STATE" == "EXIT" ]]; then
  # Restore idle settings
  SET_VAR "config" "settings/power/idle_display" $IDLEDISP
  SET_VAR "config" "settings/power/idle_mute" $IDLEMUTE
  SET_VAR "config" "settings/power/idle_sleep" $IDLESLEEP
  if [[ "$DEVICE_ID" == "rg35xx-sp" || "$DEVICE_ID" == "rg34xx-sp" ]]; then
    SET_VAR "config" "settings/advanced/lidswitch" $LIDSWITCHSET
  fi
  HOTKEY restart
  # Restore backlight value
  DISPLAY_WRITE lcd0 setbl $BACKLIGHT_VAL
fi